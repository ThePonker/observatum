Text File Summary:
- First lines:
"""
Database Migrations
Handles schema updates for iRecord integration
"""

import sqlite3
import logging
import uuid
from datetime import datetime

logger = logging.getLogger(__name__)


class DatabaseMigrations:
    """Handles database schema migrations"""
    
    @staticmethod
    def add_irecord_fields(conn):
        """
        Add iRecord integration fields to records table
        
        Args:
            conn: SQLite database connection
            
        Returns:
            bool: True if migration successful
        """
        cursor = conn.cursor()
        
        try:

- Last lines:
            logger.info(f"Generated UUIDs for {count} existing records")
            return count
            
        except sqlite3.Error as e:
            logger.error(f"Error generating UUIDs: {e}")
            conn.rollback()
            return 0
    
    @staticmethod
    def run_all_migrations(conn):
        """
        Run all database migrations
        
        Args:
            conn: SQLite database connection
            
        Returns:
            bool: True if all migrations successful
        """
        logger.info("Running database migrations...")
        
        # Add new fields
        if not DatabaseMigrations.add_irecord_fields(conn):
            return False
        
        # Generate UUIDs for existing records
        DatabaseMigrations.generate_uuids_for_existing_records(conn)
        
        logger.info("All migrations complete")
        return True
